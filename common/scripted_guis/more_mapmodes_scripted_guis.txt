scripted_gui = {

	more_mapmodes_guarantees_map_mode_window = {
		context_type = player_context

		window_name = "more_mapmodes_guarantees_map_mode_window"
		parent_window_token = top_bar

		mapmode = more_mapmodes_guarantees_map_mode

		visible = {
			is_ai = no
			var:ROOT.more_mapmodes_guarantees_map_mode_target?ROOT.id = {
				set_temp_variable = { temp_target = THIS.id }
			}
		}

		effects = {
			button_click = {
				if = {
					limit = {
						has_variable = show_more_mapmodes_guarantees_map_mode_list_window
					}
					clear_variable = show_more_mapmodes_guarantees_map_mode_list_window
				}
				else = {
					set_variable = { show_more_mapmodes_guarantees_map_mode_list_window = 1 }
				}
			}
			button_right_click = {
				clear_variable = more_mapmodes_guarantees_map_mode_target
				force_update_map_mode = {
					limit = {
						tag = ROOT
					}
					mapmode = more_mapmodes_guarantees_map_mode
				}
			}
		}
	}

	more_mapmodes_guarantees_map_mode_list_window = {
		context_type = player_context

		window_name = "more_mapmodes_guarantees_map_mode_list_window"
		parent_window_name = "more_mapmodes_guarantees_map_mode_window_instance"

		mapmode = more_mapmodes_guarantees_map_mode

		visible = {
			is_ai = no
			has_variable = show_more_mapmodes_guarantees_map_mode_list_window
		}

		effects = {
			close_button_click = {
				clear_variable = show_more_mapmodes_guarantees_map_mode_list_window
			}
			entry_button_click = {
				if = {
					limit = {
						tag = ROOT
					}
					clear_variable = more_mapmodes_guarantees_map_mode_target
				}
				else = {
					ROOT = { set_variable = { more_mapmodes_guarantees_map_mode_target = PREV.id } }
				}
				ROOT = {
					force_update_map_mode = {
						limit = {
							tag = ROOT
						}
						mapmode = more_mapmodes_guarantees_map_mode
					}
					clear_variable = show_more_mapmodes_guarantees_map_mode_list_window
				}
			}
		}

		dynamic_lists = {
			more_mapmodes_guarantees_map_mode_country_list_gridbox = {
				array = global.countries
				entry_container = "[This.GetMoreMapModesGuaranteesMapModeCountryListEntryContainer]"
				change_scope = yes
			}
		}
	}

	more_mapmodes_guarantees_map_mode_mapicons_window = {
		context_type = country_mapicon

		window_name = "more_mapmodes_guarantees_map_mode_mapicons_window"
		mapmode = more_mapmodes_guarantees_map_mode

		visible = {
			ROOT = {
				is_ai = no
			}
		}

		effects = {
			button_click = {
				if = {
					limit = {
						tag = ROOT
					}
					clear_variable = more_mapmodes_guarantees_map_mode_target
				}
				else = {
					ROOT = { set_variable = { more_mapmodes_guarantees_map_mode_target = PREV.id } }
				}
				ROOT = {
					force_update_map_mode = {
						limit = {
							tag = ROOT
						}
						mapmode = more_mapmodes_guarantees_map_mode
					}
					clear_variable = show_more_mapmodes_guarantees_map_mode_list_window
				}
			}
		}

		triggers = {
			button_visible = {
				ROOT = {
					NOT = { check_variable = { more_mapmodes_guarantees_map_mode_target = PREV.id } }
				}
				OR = {
					NOT = { tag = ROOT }
					ROOT = { has_variable = more_mapmodes_guarantees_map_mode_target }
				}
			}
		}
	}
}